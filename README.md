
# AVQA Key Subset Selection and Training

This repository contains the code for training a model and selecting a key subset for Audio-Visual Question Answering (AVQA). The training process is implemented in `main_training.py`, and the key subset used for evaluation is stored in `avqa-key-sub.json`.

---

## Key Subset Selection Algorithm

The key subset selection algorithm operates based on the following parameters:

- **`N` (Number of Epochs):** The total number of training epochs used for filtering (default: 15).
- **`k` (Grouping Factor):** The number of epochs to merge groups for weighted indices counting (default: 5).
- **`ratio` (Decreasing Weight Ratio):** The ratio by which the weights decrease for consecutive groups (default: 0.618).
- **`num` (Key Subset Size):** The number of samples to include in the final key subset (default: size of the test set).

### Algorithm Workflow

1. **Epoch-Level Recording:** During training, for each epoch, the algorithm records the indices of samples retained in the `infobatch` for each batch.

2. **Grouping and Weighted Merging:** 
   - Divide the `N` epochs into `N // k + 1` groups.
   - For each group, calculate the cumulative occurrence count of each sample's indices across the `k` epochs.
   - Assign weights to each group such that the weight of a group is scaled by the `ratio` relative to the previous group.
   - Combine the weighted indices counts across all groups.

3. **Subset Selection:**
   - Sort the combined indices in descending order based on their cumulative weights.
   - Select the top `num` samples to form the key subset.

### Experimental Setup

- **`N` = 15:** Total number of epochs.
- **`k` = 5:** Grouping factor.
- **`ratio` = 0.618:** Decreasing weight ratio.
- **`num`:** Equals the size of the test set.

The final key subset is saved as `avqa-key-sub.json`.

---

## Code Overview

### 1. Training Code
The main training script is located at:
```
main_training.py
```

### 2. Key Subset File
The key subset generated by the algorithm is stored in:
```
avqa-key-sub.json
```

---

## How to Run the Code

### 1. Install Dependencies
Ensure you have all the required Python packages installed. You can use:
```bash
pip install -r requirements.txt
```

### 2. Training
Run the training script:
```bash
python main_training.py --config config.yaml
```
Ensure the configuration file (`config.yaml`) is correctly set up with the desired parameters.

### 3. Key Subset Generation
The key subset will be automatically generated during the training process and saved as `avqa-key-sub.json`.

---

## Citation
If you use this code or method in your work, please cite:
```
[Add your relevant citation here]
```

---

## License
[Specify the license type for your repository, e.g., MIT, Apache 2.0, etc.]
